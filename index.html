<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Strip Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f0f0f0;
        }

        h1 {
            text-align: center;
            color: #333;
        }

        #flightPlan {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }

        button {
            background-color: #4caf50;
            color: white;
            padding: 10px;
            border: none;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        #flightStrips {
            margin-top: 20px;
        }

        .flight-box {
            border: 1px solid #ccc;
            background-color: white;
            padding: 10px;
            margin-bottom: 10px;
            width: 100%;
            position: relative;
            box-sizing: border-box;
            border-radius: 5px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        }

        .inbound {
            background-color: #ffcccc;  /* Light red for inbound flights */
        }

        .outbound {
            background-color: #ccffcc;  /* Light green for outbound flights */
        }

        .vfr {
            background-color: #ccccff;  /* Light blue for VFR flights */
        }

        h3 {
            margin: 0;
            color: #333;
        }

        p {
            margin: 5px 0;
            color: #666;
        }

        .delete-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            color: #aaa;
            font-size: 18px;
        }

        .delete-icon:hover {
            color: #f00;
        }
    </style>
</head>
<body>
    <h1>Flight Strip Manager</h1>

    <div>
        <label for="flightPlan">Paste Flight Plan:</label>
        <textarea id="flightPlan" rows="8" cols="40" placeholder="Paste your flight plan here"></textarea>
        
        <button onclick="addFlightStrip()">Add Flight Strip</button>
    </div>

    <div id="flightStrips">
        <h2>Flight Strips:</h2>
        <div id="flightList"></div>
    </div>

    <script>
        function FlightStrip(callsign, aircraft, departing, arriving, route, flightLevel, squawk) {
            this.callsign = callsign;
            this.aircraft = aircraft;
            this.departing = departing;
            this.arriving = arriving;
            this.route = route;
            this.flightLevel = flightLevel;
            this.squawk = squawk;
        }

        function FlightStripManager() {
            this.flightStrips = [];

            this.addFlightStrip = function (flightStrip) {
                this.flightStrips.push(flightStrip);
                this.displayFlightStrips();
            };

            this.removeFlightStrip = function (squawk) {
                this.flightStrips = this.flightStrips.filter(strip => strip.squawk !== squawk);
                this.displayFlightStrips();
            };

            this.displayFlightStrips = function () {
                const flightList = document.getElementById('flightList');
                flightList.innerHTML = '';

                if (this.flightStrips.length === 0) {
                    const noFlightsMessage = document.createElement('p');
                    noFlightsMessage.textContent = 'No flight strips available.';
                    flightList.appendChild(noFlightsMessage);
                } else {
                    this.flightStrips.forEach(function (strip) {
                        const flightBox = document.createElement('div');
                        flightBox.className = 'flight-box';

                        // Determine class based on Departing and Arriving information
                        if (strip.departing && strip.arriving) {
                            flightBox.classList.add('outbound');
                        } else if (strip.departing) {
                            flightBox.classList.add('inbound');
                        } else {
                            flightBox.classList.add('vfr');
                        }

                        const callsignHeader = document.createElement('h3');
                        callsignHeader.textContent = `Callsign: ${strip.callsign}`;
                        flightBox.appendChild(callsignHeader);

                        const aircraftInfo = document.createElement('p');
                        aircraftInfo.textContent = `Aircraft: ${strip.aircraft}`;
                        flightBox.appendChild(aircraftInfo);

                        const departingInfo = document.createElement('p');
                        departingInfo.textContent = `Departing: ${strip.departing || 'N/A'}`;
                        flightBox.appendChild(departingInfo);

                        const arrivingInfo = document.createElement('p');
                        arrivingInfo.textContent = `Arriving: ${strip.arriving || 'N/A'}`;
                        flightBox.appendChild(arrivingInfo);

                        const routeInfo = document.createElement('p');
                        routeInfo.textContent = `Route: ${strip.route || 'N/A'}`;
                        flightBox.appendChild(routeInfo);

                        const flightLevelInfo = document.createElement('p');
                        flightLevelInfo.textContent = `Flight Level: ${strip.flightLevel || 'N/A'}`;
                        flightBox.appendChild(flightLevelInfo);

                        const squawkInfo = document.createElement('p');
                        squawkInfo.textContent = `Squawk: ${strip.squawk || 'N/A'}`;
                        flightBox.appendChild(squawkInfo);

                        const deleteIcon = document.createElement('span');
                        deleteIcon.className = 'delete-icon';
                        deleteIcon.innerHTML = '&#10006;'; // Unicode character for 'X'
                        deleteIcon.onclick = function () {
                            flightManager.removeFlightStrip(strip.squawk);
                        };

                        flightBox.appendChild(deleteIcon);

                        flightList.appendChild(flightBox);
                    });
                }
            };

            this.generateSquawkCode = function () {
                let squawkCode;
                do {
                    squawkCode = Math.floor(Math.random() * (7499 - 7000 + 1)) + 7000;
                } while (this.isSquawkCodeTaken(squawkCode) || /[89]/.test(squawkCode.toString()));

                return squawkCode;
            };

            this.isSquawkCodeTaken = function (code) {
                return this.flightStrips.some(strip => strip.squawk === code);
            };
        }

        const flightManager = new FlightStripManager();

        function addFlightStrip() {
            const flightPlanInput = document.getElementById('flightPlan');
            const flightPlanText = flightPlanInput.value;

            // Parse the flight plan text and create a FlightStrip object
            const flightStrip = parseFlightPlan(flightPlanText);

            if (flightStrip) {
                flightManager.addFlightStrip(flightStrip);
                flightPlanInput.value = '';  // Clear the textarea after adding the flight strip
            } else {
                alert('Invalid flight plan format. Please check and try again.');
            }
        }

        function parseFlightPlan(flightPlanText) {
            // Implement your parsing logic here based on the provided flight plan format
            // For simplicity, let's assume each line contains key: value pairs
            const lines = flightPlanText.split('\n');
            const flightStrip = {};

            lines.forEach(function (line) {
                const [key, ...values] = line.split(':').map(item => item.trim());
                flightStrip[key] = values.join(':').trim();
            });

            // Validate if essential information is present
            if (flightStrip.Callsign && flightStrip.Aircraft && (flightStrip.Departing || flightStrip.Arriving) && flightStrip.Route && flightStrip['Flight Level']) {
                return new FlightStrip(
                    flightStrip.Callsign,
                    flightStrip.Aircraft,
                    flightStrip.Departing,
                    flightStrip.Arriving,
                    flightStrip.Route,
                    flightStrip['Flight Level'],
                    flightManager.generateSquawkCode()
                );
            } else {
                return null;  // Return null if essential information is missing
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            flightManager.displayFlightStrips();
        });
    </script>
</body>
</html>